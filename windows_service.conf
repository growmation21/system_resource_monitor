# System Resource Monitor - Windows Service Configuration
# This file can be used with NSSM (Non-Sucking Service Manager) to run as Windows service

[Service Configuration]
Service Name: SystemResourceMonitor
Display Name: System Resource Monitor
Description: Real-time system resource monitoring service with web interface

[Executable Configuration]
Path: python.exe
Arguments: "{PROJECT_ROOT}\launch_monitor.py" --minimized
Startup Directory: {PROJECT_ROOT}

[Service Settings]
Startup Type: Automatic (Delayed Start)
Account: Local System
Environment Variables:
  - PYTHONPATH={PROJECT_ROOT};{PROJECT_ROOT}\back-end

[Process Settings]
Process Priority: Normal
CPU Affinity: All CPUs
Memory Limit: 512MB

[Logging]
Log Level: Information
Log File: {PROJECT_ROOT}\logs\service.log
Rotate Logs: Yes
Max Log Size: 10MB
Max Log Files: 5

[Recovery Settings]
First Failure: Restart Service (1 minute delay)
Second Failure: Restart Service (5 minute delay)
Subsequent Failures: Restart Service (10 minute delay)
Reset Failure Count: 24 hours

[Dependencies]
Required Services:
  - Eventlog
  - RpcSs

[Installation Instructions]
1. Download NSSM from https://nssm.cc/download
2. Extract nssm.exe to a system directory
3. Run as Administrator: nssm install SystemResourceMonitor
4. Configure the service using the GUI or command line:
   - Path: C:\Path\To\Python\python.exe
   - Arguments: "C:\Path\To\Project\launch_monitor.py" --minimized
   - Startup directory: C:\Path\To\Project
5. Start the service: nssm start SystemResourceMonitor

[Command Line Installation]
# Install service
nssm install SystemResourceMonitor "C:\Python\python.exe" "C:\Project\launch_monitor.py" --minimized
nssm set SystemResourceMonitor AppDirectory "C:\Project"
nssm set SystemResourceMonitor DisplayName "System Resource Monitor"
nssm set SystemResourceMonitor Description "Real-time system resource monitoring"
nssm set SystemResourceMonitor Start SERVICE_AUTO_START

# Configure logging
nssm set SystemResourceMonitor AppStdout "C:\Project\logs\service.log"
nssm set SystemResourceMonitor AppStderr "C:\Project\logs\service-error.log"

# Start service
nssm start SystemResourceMonitor

[Removal Instructions]
# Stop and remove service
nssm stop SystemResourceMonitor
nssm remove SystemResourceMonitor confirm
